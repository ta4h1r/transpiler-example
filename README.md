Adopted from 

https://github.com/airportyh/smallang